https://www.runoob.com/python/python-reg-expressions.html

https://www.liaoxuefeng.com/wiki/1016959663602400/1017639890281664

```python
import re
# 在正则表达式里，匹配一个 \ 需要用 \\\\

x = '\hello'

m = re.match('\\\\', x)
```

re.Match类

# 常用方法

```python
# match: 查找字符串，返回的结果是一个 re.match 对象
# search: 查找字符串，返回的结果是一个 re.match 对象
# finditer
# findall
# fullmatch

# replace
```



match 与 search：

- 只对字符串查询一次
- 返回值类型都是re.Match 类型的对象
- match 从头开始匹配，search 在整个字符串里进行匹配

```python
import re

m1 = re.match(r'good', 'hello world good morning.')
print('re.match : ', m1)  # None

m2 = re.search(r'good', 'hello world good morning.')
print('re.search : ', m2)  # <re.Match object; span=(12, 16), match='good'>

# 返回值是个迭代器，迭代器中的每个对象是 re.Match 对象
m3 = re.finditer(r'x', 'oxxooxoox')
print('re.finditer : ', m3)  # <callable_iterator object at 0x00000272B504AE10>

print(next(m3))  # <re.Match object; span=(1, 2), match='x'>

m4 = re.findall(r'x', 'oxxooxoox')
print('re.findall : ', m4)

# 需要完全匹配，不能完全匹配返回None
m5 = re.fullmatch(r'hello world', 'hello world')
print('re.fullmatch : ', m5)
```

# re.Match

| 属性或方法        | 说明                                                         |
| ----------------- | ------------------------------------------------------------ |
| .pos              | 搜索的开始位置                                               |
| .endpos           | 结束位置                                                     |
| .string           | 被搜索的字符串                                               |
| .re               | 当前使用的正则表达式对象(`re.compile('...')`)                |
| .lastindex        | 最后匹配的组索引(对应`groups()`)                             |
| .lastgroup        | 最后匹配的组名(对应`groupdict()`)                            |
| .group(index=0)   | 某个分组的匹配结果，默认匹配整个正则表达式                   |
| .groups()         | 所有分组的匹配结果                                           |
| .groupdict()      | 返回组名作为key，匹配结果为value的字典                       |
| .start([group])   | 获取组的开始位置                                             |
| .end([group])     |                                                              |
| .span([group])    | 组的开始和结束位置                                           |
| .expand(template) | 使用组的匹配结果来替换模板template中的内容，并把替换后的字符串返回 |



```python
import re

# 贪婪模式，因此匹配到的是 `mparccr` 而不是 `mpar`
m = re.search(r'm.*r', 'comparccre')
# print(dir(m))

print(m.pos, m.endpos)  # 起始和结尾的位置，不包括结尾

print(m.span())  # (m.pos, m.endpos)

# 获取匹配的字符串结果
print(m.group())
print(m.group(0))  # group 可以传参，表示第 n 个分组
# print(m.group(1))  # 报错

# 1. 在正则表达式里使用 () 表示一个分组
# 2. 如果没有分组，默认只有一组
# 3. 分组下标从 0 开始

# 未分组
m2 = re.search(r'0.*1.*2.*3', '0__1__2__3')
print(m2.group(0))

# 分组 此时有四个分组
m3 = re.search(r'(0.*)(1.*)(2.*3)', '0__1__2__3')
print('group()  : ', m3.group())  # 默认拿第0组
print('group(0) : ', m3.group(0))  # 第0组就是全部匹配
print('group(1) : ', m3.group(1))
print('group(2) : ', m3.group(2))
print('group(3) : ', m3.group(3))

print('groups()', m3.groups())  # 拿到 分组的元组 ('0__', '1__', '2__3')

print('groupdict()', m3.groupdict())  # 此时是 {} 空字典

# (?P<name>表达式)  可以给分组起名字
m4 = re.search(r'(0.*)(?P<g1>1.*)(?P<g23>2.*3)', '0__1__2__3')
print('group("g1") : ', m4.group("g1"))
print('groupdict()', m4.groupdict())  # 此时是 {} 空字典
```

# re.compile方法

方便重复使用一个匹配模式

```python
import re

r = re.compile(r'f.*e')
m = r.search('difference')

print(m)
```

# 正则修饰符

| 修饰符 | 描述                                                         |
| ------ | ------------------------------------------------------------ |
| re.I   | 使匹配对大小写不敏感                                         |
| re.S   | 使 `.` 匹配包括换行在内的所有字符                            |
| re.M   | 多行匹配，影响 ^ 和 $                                        |
| re.L   | 做本地化识别（locale-aware）匹配                             |
| re.U   | 根据Unicode字符集解析字符。这个标志影响 \w, \W, \b, \B.      |
| re.X   | 该标志通过给予你更灵活的格式以便你将正则表达式写得更易于理解。 |

```python
import re

m1 = re.findall(r'\w+$', 'i am boy\nyou are girl\nhe is man')
print(m1)

# re.M 使得 ^ 和 $ 匹配换行符
m2 = re.findall(r'\w+$', 'i am boy\nyou are girl\nhe is man', re.M)
print(m2)
```

# 正则匹配规则

## 非打印字符

| 字符  | 说明                                                         |
| ----- | ------------------------------------------------------------ |
| `\cx` | 匹配由x指明的控制字符。<br />例如：\cM 匹配Ctrl-M或回车符<br />x的值必须为A-Z 或 a-z之间。否则c将视为一个原义的'c'字符 |
| `\f`  | 换页符。等价于 `\x0c` 或 `\cL`                               |
| `\n`  | 换行符。等价于 `\x0a` 或 `\cJ`                               |
| `\r`  | 回车符。等价于 `\x0d` 或 `\cM`                               |
| `\t`  | 制表符。等价于 `\x09` 或` \cI`                               |
| `\v`  | 垂直制表符。等价于 `\x0b` 或 `\cK`                           |
| `\s`  | 匹配任何空白字符。等价于 `[\f\n\r\t\v]`                      |
| `\S`  | 匹配非空白字符。等价于 `[^\f\n\r\t\v]`                       |



## 特殊字符

| 特殊字符 | 说明                                                         |
| -------- | ------------------------------------------------------------ |
| `?`      | 表示0次或1次<br />将贪婪模式转换为非贪婪模式                 |
| `*`      | 表示0次或多次。                                              |
| `+`      | 表示1次或多次。                                              |
| `.`      | 匹配除了`\n`以外的所有字符                                   |
| `{n}`    | `fo{2}d`只匹配`food`                                         |
| `{,n}`   | `fo{,2}d`匹配`fd`,`fod`, `food`                              |
| `{n,}`   | `fo{2,}d`匹配`food`, `foood`,`fooood`, ......                |
| `{n, m}` | `fo{2, 4}`只匹配`food`, `foood`,`fooood`                     |
| `()`     | 标记一个子表达式的开始和结束位置。子表达式可以获取供以后使用。<br />re.findall()只会提取括号内的内容 |
| `[...]`  | 用来表示一组字符,单独列出：[amk] 匹配 'a'，'m'或'k'          |
| `[^...]` | 不在[]中的字符：`[^abc] `匹配除了a,b,c之外的字符。           |
| `|`      | 表示或者 `f(a|ab|cc)m`匹配`fam`,`fabm`,`fccm`                |
| `\`      | 转移字符，将下一个字符标记为特殊字符、或原义字符、或向后引用、或八进制转义符 |
| `^`      | 以指定的内容开头。受`re.M`影响                               |
| `$`      | 以指定的内容结尾。受`re.M`影响                               |

## 字母的特殊含义

| 字母 | 说明                                                  |
| ---- | ----------------------------------------------------- |
| `\d` | 数字字符。等价于[0-9]                                 |
| `\D` | 非数字字符                                            |
| `\w` | 匹配字母数字下划线。等价于`[0-9a-zA-Z_\u9fa5-\u4e00]` |
| `\W` | 非字母数字下划线                                      |

# 正则表达式应用

```python
import re

num = input('请输入数字: ')
if re.fullmatch(r'\d+(\.\d+)?', num):
    print(float(num))
else:
    print('不是一个数字')
```

# 正则表达式替换

```python
import re

m1 = re.sub(r'\d+', '<num>', 'hello 123 gg 29')
print(m1)

# 字符串的数字变成两倍
def test(x):
    # 传入的是re.Match对象
    x = x.group()
    return str(int(x) * 2)
m2 = re.sub(r'\d+', test, 'hello 123 gg 29')
print(m2)


```

# 贪婪模式与非贪婪模式

在贪婪模式前加个`?`会变成非贪婪模式，匹配尽量少的结果

`??`表示0次匹配

```python
# python 中默认贪婪
import re

m1 = re.findall(r'r.*r', 'r___r__r_r')
print(m1)

m2 = re.findall(r'r.*?r', 'r___r__r_r')
print(m2)
```



