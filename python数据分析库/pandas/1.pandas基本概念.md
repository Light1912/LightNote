# pandas介绍

官方网站：https://pandas.pydata.org/

pandas是python的其中一个库，是一款快速、强大、灵活且易于使用的开源数据分析和操作工具

pandas的两个基本数据类型：Series, DataFrame

围绕这两个数据类型，pandas提供了一系列关于这两个数据类型的操作

- 基本操作
- 运算操作
- 特征类操作
- 关联类操作

pandas非常强调数据和索引之间的关系

# Series

Series 是带有标签的一维数组，可以保存任何数据类型（整数，字符串，浮点数，Python对象等）,轴标签统称为索引

## Series创建

[pandas.Series](https://pandas.pydata.org/docs/reference/api/pandas.Series.html)

```python
class pandas.Series(data=None, index=None, dtype=None, name=None, copy=False)
```

- data：数据，可以是字典、数组、标量
- index：索引
- name：在使用多个Series拼接成DataFrame时，设置name比较有用
- copy：默认为False，如果是由numpy数组创建的Series，当Series发生改变时，原数组也会被改变。

### 字典创建

值可以是不同的数据类型

```python
import pandas as pd

data = {'a': 1, 'b': 2.2, 'c': 'hello'}
s = pd.Series(data)
print(s)
```

```
a        1
b      2.2
c    hello
dtype: object
```

### 数组创建

数组必须是一维数组

```python
import pandas as pd
import numpy as np

a = np.array([1, 2, 3])
s = pd.Series(a)
print(s)
```

```
0    1
1    2
2    3
dtype: int32
```

可以在创建时指定索引和数据类型

```python
a = np.array([1, 2, 3])
s = pd.Series(a, index=['a', 'b', 'c'], dtype='float32')
print(s)
```

```
a    1.0
b    2.0
c    3.0
dtype: float32
```

### 标量创建

```python
import pandas as pd
import numpy as np

s = pd.Series(10, index=range(3))
print(s)
```

```
0    10
1    10
2    10
dtype: int64
```

## Series索引

索引类似于numpy.ndarray

```python
import pandas as pd
s = pd.Series([1, 2, 3, 4], index=['a', 'b', 'c', 'd'])

# 单元素索引
```

### 单元素索引

```python
print(s[1])  # 2
print(s['b'])  # 2
print(s.iloc[1])  # 2
print(s.loc['b'])  # 2
```

### 多元素索引

```python
print(s[[0, 2]])
print(s[['a', 'c']])
print(s.iloc[[0, 2]])
print(s.loc[['a', 'c']])
```

```
a    1
c    3
dtype: int64
```

### 切片索引

注意切片索引和多元素索引的区别

切片索引的**中括号要少一层嵌套**

```python
print(s[1:3])
print(s['b':'c'])
print(s.iloc[1:3])
print(s.loc['b':'c']) 
```

```
b    2
c    3
dtype: int64
```

### 布尔索引

布尔索引通常用作筛选，可以基于要筛选的Series创建一个和其形状相同的Series

```python
m = s > 2
print(m)
```

```
a    False
b    False
c     True
d     True
dtype: bool
```

使用布尔索引筛选原数组

```python
s[m]
```

```python
c    3
d    4
dtype: int64
```

熟悉后可以省略中间变量m

```python
s[s > 2]
# 效果上
```

## Series属性

常用属性，其他属性可以到官方文档查看

| 属性   | 说明                  |
| ------ | --------------------- |
| shape  | 返回形状，一般是(n, ) |
| size   | 元素的个数            |
| index  | 返回索引              |
| values | 返回数据              |
| dtype  | 数据类型              |
| name   | 数组名称              |

举个例子

```python
import pandas as pd

s = pd.Series([1, 2, 3, 4], index=['a', 'b', 'c', 'd'], name='demo')

print(s.shape)  # (4,)
print(s.size)  # 4
print(s.index)  # Index(['a', 'b', 'c', 'd'], dtype='object')
print(s.values)  # [1 2 3 4]
print(s.dtype)  # int64
print(s.name)  # demo
```

## Series方法

### 添加元素

```python
import pandas as pd

s = pd.Series([1, 2, 3], index=['a', 'b', 'c'])
s['d'] = 4
print(s)
```

```
a    1
b    2
c    3
d    4
dtype: int64
```

如果创建时未指定index

```python
import pandas as pd

s = pd.Series([1, 2, 3])
s[4] = 4
s[100] = 5
print(s)
```

```
0      1
1      2
2      3
4      4
100    5
dtype: int64
```

### 修改元素

```python
import pandas as pd

s = pd.Series([1, 2, 3], index=['a', 'b', 'c'])
s['a'] = 100
s[['b','c']] = 200
print(s)
```

```
a    100
b    200
c    200
dtype: int64
```



### [pandas.Series.append()](https://pandas.pydata.org/docs/reference/api/pandas.Series.append.html)

在一个数组的结尾拼接另一个数组

不改变原数组，索引有可能重复

```python
import pandas as pd

s1 = pd.Series([1, 2, 3])
s2 = pd.Series([4, 5, 6])
s3 = pd.Series([4, 5, 6], index=[3, 4, 5])
s1.append(s2)
```

```
0    1
1    2
2    3
0    4
1    5
2    6
dtype: int64
```

另一种情况

```python
s1.append(s3)
```

```
0    1
1    2
2    3
3    4
4    5
5    6
dtype: int64
```

如果使用参数`ignore_index=True`，会自动重排索引

```python
s1.append(s2, ignore_index=True)
```

```
0    1
1    2
2    3
3    4
4    5
5    6
dtype: int64
```



### [pandas.Series.head()](https://pandas.pydata.org/docs/reference/api/pandas.Series.head.html)

```python
Series.head(n=5)
```

数据量比较大时，可以使用head() / tail() 方法查看数组的头尾，默认查看5条数据

```python
import pandas as pd

s = pd.Series(range(50))
s.head()
```

```python
0    0
1    1
2    2
3    3
4    4
dtype: int64
```

### [pandas.Series.tail()](https://pandas.pydata.org/docs/reference/api/pandas.Series.tail.html)

```python
import pandas as pd

s = pd.Series(range(50))
s.tail(3)
```

```
47    47
48    48
49    49
dtype: int64
```

### [pandas.Series.rename()](https://pandas.pydata.org/docs/reference/api/pandas.Series.rename.html)

```python
Series.rename(index=None, *, axis=None, copy=True, inplace=False, level=None, errors='ignore')
```

数组重命名，默认不会改变原数组

```python
import pandas as pd

s = pd.Series([1, 2, 3], name='apple')
print(s.name)  # apple

s2 = s.rename('banana')
print(s.name)  # apple
print(s2.name)  # banana
```

如果想直接改变原数组，需要用到参数`inplace`

```python
s.rename('banana', inplace=True)
```

### [pandas.Series.reindex()](https://pandas.pydata.org/docs/reference/api/pandas.Series.reindex.html)

```python
Series.reindex(index=None, **kwargs)
```

会根据新索引重新排序，如果当前索引不存在，则引入缺失值。

不改变原数组

```python
s = pd.Series([1, 2, 3], index = ['a','b','c'])
s1 = s.reindex(['c','b','a','d'])
print(s1)
```

```
c    3.0
b    2.0
a    1.0
d    NaN
dtype: float64
```

可以指定填充空缺值

```python
s2 = s.reindex(['c','b','a','d'], fill_value=0)
print(s2)
```

```
c    3
b    2
a    1
d    0
dtype: int64
```

### [pandas.Series.drop()](https://pandas.pydata.org/docs/reference/api/pandas.Series.drop.html)

根据索引删除数组元素，不改变原数组。

```python
import pandas as pd
s = pd.Series(range(4), index=list('abcd'))
print(s)
```

```
a    0
b    1
c    2
d    3
dtype: int64
```

删除单个元素

```python
s1 = s.drop('b')
print(s1)
```

```
a    0
c    2
d    3
dtype: int64
```

删除多个元素

```python
s2 = s.drop(['a', 'c'])
print(s2)
```

```
b    1
d    3
dtype: int64
```

### [pandas.Series.isnull()](https://pandas.pydata.org/docs/reference/api/pandas.Series.isnull.html)

```python
import pandas as pd
s = pd.Series([5, 6, np.NaN])
s.isna()
```

```
0    False
1    False
2     True
dtype: bool
```

### [pandas.Series.notnull()](https://pandas.pydata.org/docs/reference/api/pandas.Series.notnull.html)

```python
import pandas as pd
s = pd.Series([5, 6, np.NaN])
s.notna()
```

```
0     True
1     True
2    False
dtype: bool
```

## Series特性

### 自动对齐

Series 和 ndarray 之间的主要区别是

- Series 上的操作会根据标签自动对齐
- index顺序不会影响数值计算，运算是以标签来计算的
- 空值和任何值的计算结果都为空值

```python
import pandas as pd

s1 = pd.Series([1, 3, 5], index = ['Jack','Marry','Tom'])
s2 = pd.Series([2, 4, 6], index = ['Wang','Jack','Marry'])

print(s1 + s2)
```

```
Jack     5.0
Marry    9.0
Tom      NaN
Wang     NaN
dtype: float64
```



```python
import pandas as pd

```

