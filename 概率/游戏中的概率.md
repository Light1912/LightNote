

## 题2 求平均暴击率

如果赋予了基础概率值，实际上和之前差不大多

(以下待施工)
$$
P(N) = a + C(N-1)
$$

| N    | 第N次暴击的几率 | 之前没暴击的几率              | 第N次攻击才暴击的概率                   |
| ---- | --------------- | ----------------------------- | --------------------------------------- |
| 1    | $a$             | 1                             | $a$                                     |
| 2    | $a+C$           | $(1-a)$                       | $(a+C)(1-a)$                            |
| 3    | $a+2C$          | $(1-a)(1-a-C)$                | $(a+2C)(1-a)(1-a-C)$                    |
| n    | $a+(n-1)C$      | $\prod_{i=2}^{n}[1-a-(i-2)C]$ | $[a+(i-1)C]\prod_{i=2}^{n}[1-a-(i-2)C]$ |
| x    |                 |                               |                                         |

基础暴击率为5%，如果当前攻击未命中，则下一次暴击率增加10%，问：平均暴击率为多少。

对于这题，也就是$a=0.05$，$C=0.1$，求平均暴击率

```python
a = 0.05  # 基础暴击率
c = 0.1  # 增量
pn = a  # 当前暴击率
n = 1  # 第n次攻击
ans = 0
while pn < 1:
    tmp = n * (a + (n-1)*c)
    i = 2
    while i <= n:
        tmp *= (1 - a - (i - 2) * c)
        i += 1
    ans += tmp
    n += 1
    pn += c
print("平均需要%.5f次攻击暴击一次，暴击率为%.4f%%" % (ans, 1 / ans * 100))
```

```
平均需要4.11399次攻击暴击一次，暴击率为24.3073%
```

## 题3 求连续n个元素需要的平均次数

有4种不同的元素，水火风电。每次获取一个元素的概率是一样的（均为25%），问平均要多少次才能集齐4种元素。

![image-20210220142917859](img/image-20210220142917859.png)

分析：

| 已获不同元素的个数 | 获得不同元素的概率 | 平均要几次才能获得不同元素 |
| ------------------ | ------------------ | -------------------------- |
| 0                  | 100%               | 1                          |
| 1                  | 75%                | 1 / 0.75 = 1.333           |
| 2                  | 50%                | 1 / 0.5 = 2                |
| 3                  | 25%                | 1 / 0.25 = 4               |

答：

平均需要1 + 1.333 + 2 + 4 = 8.333次才能集齐4种元素

例题3：有4种不同的元素，水火风电。每次获取一个元素的概率是一样的（均为25%），问平均需要多少次才能连续收集两个火元素。

分析：

分析有几种状态：

- 状态1：往前1次不是火元素
- 状态2：往前1次是火元素，往前2次不是火元素
- 状态3：往前1次是火元素，往前2次也是火元素（结束态）

状态转换的情况：

- 状态1 → 状态2：有1/4的概率收集到火元素
- 状态1 → 状态1：有3/4的概率收集到非火元素
- 状态2 → 状态3：有1/4的概率收集到火元素
- 状态2 → 状态1：有3/4的概率收集到非火元素

如果从状态1转到了状态1，那仍需要n次才能出现两个火元素。总次数就变成了n+1，这种情况的概率是3/4 * (n+1)

如果从状态1转到了状态2，又从状态2转到了状态1。总次数变成了n+2，这种情况的概率是1/4 * 3/4 * (n+2)

如果从状态1转到状态2，又从状态2转到了状态3，这种情况的概率为：1/4 * 1/4

解这个方程：3/4 * (n+1) + 1/4 * 3/4 * (n+2) + 1/4 * 1/4 = n

可以得n = 19

## 题4 数学期望

某城市有10万个家庭，没有孩子的家庭有1000个，有一个孩子的家庭有9万个，有两个孩子的家庭有6000个，有3个孩子的家庭有3000个。求平均每个家庭有多少个孩子。

则此城市中任一个家庭中孩子的数目是一个随机变量，记为X。它可取值0，1，2，3。

